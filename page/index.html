<!DOCTYPE html>
<html><head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' />
  <link rel='stylesheet' href='/static/index.css'>
</head><body>

<div id='container'>
  <div id='page-title'>Medle #<%= it.id %></div>
  <div id='icon-btns-container'>
    <div id='icon-btn-help'>?</div>
    <div id='icon-btn-options' class='iconfont'>&#xf013;</div>
    <% if (it.isDaily) { %>
      <div id='icon-btn-archive' class='iconfont'>&#x1f4c6;</div>
    <% } %>
  </div>
  <div id='list-container'>
  </div>
  <div id='start-btn-container'>
    <div id='text-loading' class='text-fading'>Loading… <span id='text-loading-progress'></span></div>
    <div class='list btn hidden' id='btn-start'>
      <div class='bg'>
        <div class='bubble' onclick='startGame()'>
          <div class='content'></div>
        </div>
      </div>
      <div class='fg'>
        <div class='bubble'><div class='content iconfont'>&#xf04b;</div></div>
      </div>
      <p id='text-tip' class='text-fading'>
        <span>试试打开声音吧~</span>
        <span>点按此前输入的圆圈，可以重新播放声音</span>
        <span>推荐在夜晚使用深色主题</span>
      </p>
    </div>
  </div>
  <div id='btns-container'>
    <div class='list btn hidden' id='input-btns-row-1'>
      <div class='bg'>
        <div class='bubble' onclick='input(1)'><div class='content'></div></div>
        <div class='bubble' onclick='input(2)'><div class='content'></div></div>
        <div class='bubble' onclick='input(3)'><div class='content'></div></div>
        <div class='bubble' onclick='input(4)'><div class='content'></div></div>
      </div>
      <div class='fg'>
        <div class='bubble solf-1'><div class='content'></div></div>
        <div class='bubble solf-2'><div class='content'></div></div>
        <div class='bubble solf-3'><div class='content'></div></div>
        <div class='bubble solf-4'><div class='content'></div></div>
      </div>
    </div>
    <div class='list btn confirm hidden' id='input-btns-confirm'>
      <div class='bg'>
        <div class='bubble' onclick='confirmGuess()'>
          <div id='input-btn-confirm-bg' class='content'></div>
        </div>
      </div>
      <div class='fg'>
        <div class='bubble'><div class='content'>确认</div></div>
      </div>
    </div>
    <div class='list btn confirm hidden' id='input-btns-reveal'>
      <div class='bg'>
        <div class='bubble' onclick='revealAnswer()'>
          <div id='input-btn-reveal-bg' class='content'></div>
        </div>
      </div>
      <div class='fg'>
        <div class='bubble'><div class='content'>谜底</div></div>
      </div>
    </div>
    <div class='list btn hidden must' id='input-btns-row-2'>
      <div class='bg'>
        <div class='bubble' onclick='input(5)'><div class='content'></div></div>
        <div class='bubble' onclick='input(6)'><div class='content'></div></div>
        <div class='bubble' onclick='input(7)'><div class='content'></div></div>
        <div class='bubble nohidden' onclick='input(-1)'>
          <div id='input-btn-del-bg' class='content'></div>
        </div>
      </div>
      <div class='fg'>
        <div class='bubble solf-5'><div class='content'></div></div>
        <div class='bubble solf-6'><div class='content'></div></div>
        <div class='bubble solf-7'><div class='content'></div></div>
        <div class='bubble nohidden'><div class='content iconfont'>&#xf55a;</div></div>
      </div>
    </div>
  </div>

  <div class='modal hidden' id='modal-intro'>
    <p class='title'>Medle 游戏规则</p>
    <p>猜出旋律中的每个音符。<p>
    <p>玩家不必具备音乐知识，Medle 可以是纯粹的数字游戏。</p>
    <p>音符用 1 至 7 的数字表示。每次猜测后，将针对每个音符给出提示。</p>
    <div class='options-btns-list'>
      <span>✨ 清晰显示</span>
      <div id='btn-high-con-alt' class='small-btn'>OFF</div>
    </div>
    <div class='list intro'>
      <div class='bg'>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble bingo'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
      </div>
      <div class='fg'>
        <div class='bubble solf-1 none'><div class='content'></div></div>
        <div class='bubble solf-2 bingo'><div class='content'></div></div>
        <div class='bubble solf-3 none'><div class='content'></div></div>
        <div class='bubble solf-4 none'><div class='content'></div></div>
        <div class='bubble solf-5 none'><div class='content'></div></div>
      </div>
    </div>
    <p style='text-align: center; color: #888'>音符“2”处于谜底中的正确位置。</p>
    <div class='list intro'>
      <div class='bg'>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble maybe'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
      </div>
      <div class='fg'>
        <div class='bubble solf-1 none'><div class='content'></div></div>
        <div class='bubble solf-2 none'><div class='content'></div></div>
        <div class='bubble solf-3 maybe'><div class='content'></div></div>
        <div class='bubble solf-4 none'><div class='content'></div></div>
        <div class='bubble solf-5 none'><div class='content'></div></div>
      </div>
    </div>
    <p style='text-align: center; color: #888'>音符“3”出现在谜底中，但并不在猜测的位置上。</p>
    <br>
    <p>若同一音符出现多次，则也会提示多次。</p>
    <div class='list intro'>
      <div class='bg'>
        <div class='bubble maybe'><div class='content'></div></div>
        <div class='bubble maybe'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble bingo'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
        <div class='bubble none'><div class='content'></div></div>
      </div>
      <div class='fg'>
        <div class='bubble solf-1 maybe'><div class='content'></div></div>
        <div class='bubble solf-1 maybe'><div class='content'></div></div>
        <div class='bubble solf-1 none'><div class='content'></div></div>
        <div class='bubble solf-1 bingo'><div class='content'></div></div>
        <div class='bubble solf-5 none'><div class='content'></div></div>
        <div class='bubble solf-6 none'><div class='content'></div></div>
      </div>
    </div>
    <p style='text-align: center; color: #888'>一个音符“1”在正确的位置；除此之外，谜底中还有两个“1”，但都不在猜测为“1”的位置上。</p>
    <br>
    <p>游戏中出现的其余记号只影响发出的声音，不影响游戏规则。</p>
    <div class='list intro'>
      <div class='bg'>
        <div class='bubble bingo'><div class='content'></div></div>
        <div class='bubble none'><div class='content'><div class='accidental sharp'></div></div></div>
        <div class='bubble none'><div class='content'><div class='accidental flat'></div></div></div>
        <div class='bubble maybe'><div class='content'><div class='tune-dot ottava'></div></div></div>
        <div class='bubble none'><div class='content'><div class='tune-dot ottava-bassa'></div></div></div>
      </div>
      <div class='fg'>
        <div class='bubble solf-1 bingo'><div class='content'></div></div>
        <div class='bubble solf-2 none'><div class='content'></div></div>
        <div class='bubble solf-3 none'><div class='content'></div></div>
        <div class='bubble solf-4 maybe'><div class='content'></div></div>
        <div class='bubble solf-5 none'><div class='content'></div></div>
      </div>
    </div>
    <p style='text-align: center; color: #888'>除数字、颜色外的记号均不影响游戏。其含义留给有兴趣的玩家自行探索。</p>
    <br>
    <p>一共有 5 次机会。游戏愉快~</p>
    <p style='color: #999'>北京时间每日零时更新谜题，记得回来呀！</p>
    <div class='bottom-shadow'></div>
  </div>
  <div class='modal hidden' id='modal-finish'>
    <p class='title'>Medle #<%= it.id %></p>
    <p><strong><%= it.workTitle %></strong> by <%= it.workAuthor %></p>
    <div id='answer-container'></div>
    <div class='list btn disabled' id='btn-play'>
      <div class='bg'>
        <div class='bubble' onclick='revealPlay()'>
          <div class='content'></div>
        </div>
      </div>
      <div class='fg'>
        <div class='bubble'><div class='content iconfont' id='btn-play-content'>&#xf141;</div></div>
      </div>
    </div>
    <p><%~ it.workDesc %></p>
    <div id='btn-share'>
      <span id='btn-share-text-share'>分享</span>
      <span id='btn-share-text-shared'>✓ 已复制到剪贴板</span>
    </div>
    <p style='color: #999'>♪<% if (it.isDaily) { %>今日<% } %>选题<span style='margin: 0 8px'>|</span><%= it.curator %></p>
    <% if (it.isDaily) { %>
      <p style='color: #999'>北京时间每日零时更新谜题，记得回来呀！</p>
    <% } %>
    <div class='bottom-shadow'></div>
  </div>
  <div class='modal hidden' id='modal-archive'>
    <p class='title'>过往谜题</p>
    <div id='archive-container'>
    </div>
    <div class='bottom-shadow'></div>
  </div>
  <div class='modal hidden' id='modal-options'>
    <p class='title'>选项</p>
    <div class='options-btns-list'>
      <span>🎶 播放音效</span>
      <div id='btn-play-sfx' class='small-btn'></div>
    </div>
    <div class='options-btns-list'>
      <span>🌙 深色主题</span>
      <div id='btn-dark-theme' class='small-btn'></div>
    </div>
    <div class='options-btns-list'>
      <span>✨ 清晰显示</span>
      <div id='btn-high-con' class='small-btn'></div>
    </div>
    <div class='options-btns-list'>
      <span>🔣 音符记号</span>
      <div id='btn-notation' class='small-btn'>
        <span id='btn-notation-text-num'>数字</span>
        <span id='btn-notation-text-solf'>唱名</span>
        <span id='btn-notation-text-roman'>罗马</span>
        <span id='btn-notation-text-aikin'>图形</span>
      </div>
    </div>
    <br>
    <div style='color: #999'>
      <span>&copy; Medle 2022</span><br>
      <span id='repo-notes'><a href='https://github.com/kawa-yoiko/medle'>程序源码</a>依照木兰公共许可证分发</span>
    </div>
    <div class='bottom-shadow'></div>
  </div>
  <% if (it.guideToToday) { %>
  <div class='modal hidden' id='modal-guide-today'>
    <p class='title'>📜</p>
    <p>正在访问的是一份过往的谜题 <strong>#<%= it.id %></strong>。</p>
    <p>希望继续游玩，还是前往今天的每日谜题 <strong>#<%= it.todayDaily %></strong> 呢？</p>
    <div id='guide-today-links'></div>
    <p style='color: #999'>北京时间每日零时更新谜题，记得回来呀！</p>
  </div>
  <% } %>
</div>
<div id='modal-bg' class='hidden'></div>

<script src='/static/howler.core.min.js'></script>
<script src='/static/clipboard.min.js'></script>
<script>
const puzzleId = <%~ JSON.stringify(it.id) %>;
const tune = <%~ JSON.stringify(it.tune) %>;
const tuneBeatDur = <%= it.tuneBeatDur %>;
const tunePitchBase = <%= it.tunePitchBase %>;
const tuneRevealBeatDur = <%= it.tuneRevealBeatDur %>;
const tuneRevealOffset = <%= it.tuneRevealOffset %>;
const isDaily = <%= it.isDaily %>;
const guideToToday = <%= it.guideToToday %>;
const todayDaily = <%~ JSON.stringify(it.todayDaily) %>;
</script>
<script src='/static/index.js'></script>

</body></html>
